"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[29],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=l(n),f=i,h=d["".concat(c,".").concat(f)]||d[f]||u[f]||r;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=f;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var l=2;l<r;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},9798:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:2},o="Creating a Certification Object",s={unversionedId:"backend/certification-object",id:"backend/certification-object",title:"Creating a Certification Object",description:"- Overview",source:"@site/docs/backend/certification-object.md",sourceDirName:"backend",slug:"/backend/certification-object",permalink:"/docs/backend/certification-object",draft:!1,editUrl:"https://github.com/RSoulatIOHK/ptt_documentation/docs/backend/certification-object.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Minimal examples",permalink:"/docs/backend/minimal-examples"},next:{title:"Vulnerabilities checked by Plutus Testing Tool",permalink:"/docs/backend/list-vulnerabilities"}},c={},l=[{value:'Overview <a name="overview"></a>',id:"overview-",level:2},{value:'Certification Object <a name="intro"></a>',id:"certification-object-",level:2},{value:'Certification Properties <a name="properties"></a>',id:"certification-properties-",level:3},{value:'Defining a Certification Object <a name="definition"></a>',id:"defining-a-certification-object-",level:3}],p={toc:l},d="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(d,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"creating-a-certification-object"},"Creating a Certification Object"),(0,i.kt)("h1",{id:"table-of-contents"},"Table of Contents"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#overview"},"Overview")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#intro"},"Certification Object"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#properties"},"Certification Properties")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#definition"},"Defining a Certification Object"))))),(0,i.kt)("h2",{id:"overview-"},"Overview ",(0,i.kt)("a",{name:"overview"})),(0,i.kt)("p",null,"This document details how to create a certification object for a DApp that is used to run tests on the Plutus Testing Tool. This document assumes that a contract model is already defined for the given Dapp. For more information on how to define a contract model follow this ",(0,i.kt)("a",{parentName:"p",href:"https://plutus-apps.readthedocs.io/en/latest/plutus/tutorials/contract-models.html"},"Contract Model Tutorial"),". "),(0,i.kt)("p",null,"Examples containing Dapps with certification objects that are compatible with the Plutus Testing Tool can be found in this ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Ali-Hill/minimal-ptt-examples"},"repo"),"."),(0,i.kt)("h2",{id:"certification-object-"},"Certification Object ",(0,i.kt)("a",{name:"intro"})),(0,i.kt)("p",null,"The certification object is a standardised way to define a list of tests to run using the defined contract model. This includes all of the tests defined in the ",(0,i.kt)("a",{parentName:"p",href:"https://plutus-apps.readthedocs.io/en/latest/plutus/tutorials/contract-models.html"},"Contract Model Tutorial"),". The certification object is defined by the following code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-haskell"},"data Certification m = Certification {\n    certCoverageIndex      :: CoverageIndex,                      -- ^ Coverage locations for on-chain test coverage.\n    certNoLockedFunds      :: Maybe (NoLockedFundsProof m),\n    certNoLockedFundsLight :: Maybe (NoLockedFundsProofLight m),\n    certCrashTolerance     :: Maybe (Instance CrashTolerance m),  -- ^ Contract model for testing robustness against off-chain code crashes.\n    certWhitelist          :: Maybe Whitelist,                    -- ^ List of allowed exceptions from on-chain code. Usually `Just 'defaultWhiteList'`.\n    certUnitTests          :: Maybe (CoverageRef -> TestTree),    -- ^ Unit tests using \"Test.Tasty\". See e.g. 'Plutus.Contract.Test.checkPredicateCoverage'.\n    certDLTests            :: [(String, DL m ())]                 -- ^ Unit tests using 'Plutus.Contract.Test.ContractModel.DL'.\n  }\n")),(0,i.kt)("p",null,"The plutus testing tool will take a certification object and run it using the ",(0,i.kt)("inlineCode",{parentName:"p"},"defaultCertification")," options. This certification object is used to test a variety of properties: "),(0,i.kt)("h3",{id:"certification-properties-"},"Certification Properties ",(0,i.kt)("a",{name:"properties"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Standard Property Test")),(0,i.kt)("p",null,"The standard property test runs the model against an emulator to check to see if there are any discrepencies between the model and emulator. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"No Locked Funds")),(0,i.kt)("p",null,"This property tests that funds locked in the contract can be retrieved by any wallet without cooperation from any other wallets. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"No Locked Funds Light")),(0,i.kt)("p",null,"This property tests that funds locked in the contract can be retrieved but allows for cooperation between wallets. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Crash Tolerance")),(0,i.kt)("p",null,"This property tests to see if a contract instance can be restarted in the event of a crash and whether once restarted the contract still behaves as expected by the model. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Double Satisfaction")),(0,i.kt)("p",null,"This property tests to see if a conctract is vulnerable to the ",(0,i.kt)("a",{parentName:"p",href:"https://plutus.readthedocs.io/en/latest/reference/writing-scripts/common-weaknesses/double-satisfaction.html"},"double satisfaction vulnerability"),". "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Other Tests")),(0,i.kt)("p",null,"Other tests such as unit tests are run using a ",(0,i.kt)("a",{parentName:"p",href:"https://hackage.haskell.org/package/tasty-1.5/docs/Test-Tasty.html"},"Tasty")," test tree."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"DL Tests")),(0,i.kt)("p",null,"DL tests are a form of unit tests using ",(0,i.kt)("a",{parentName:"p",href:"https://hackage.haskell.org/package/quickcheck-dynamic-3.3.1/docs/Test-QuickCheck-DynamicLogic.html"},"Dynamic Logic")," that run traces actions on the defined model. "),(0,i.kt)("h3",{id:"defining-a-certification-object-"},"Defining a Certification Object ",(0,i.kt)("a",{name:"definition"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Remark on Properties")),(0,i.kt)("p",null,"You may notice that there are more properties than there are fields in the certification object. This is because a certification will automatically run the standard property test and double satisfaction test by default. At the moment double satisfaction is temporarily disabled."),(0,i.kt)("p",null,"The certification object for the escrow contract model defined in the ",(0,i.kt)("a",{parentName:"p",href:"https://plutus-apps.readthedocs.io/en/latest/plutus/tutorials/contract-models.html"},"Contract Model Tutorial")," is defined by: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-haskell"},'certification :: Certification EscrowModel\ncertification = defaultCertification {\n    certCoverageIndex      = covIdx, \n    certNoLockedFunds = Just noLockProof,\n    certCrashTolerance = Just Instance,\n    certUnitTests = Just unitTest,\n    certDLTests = [("redeem test", unitTest1), ("refund test", unitTest2)],\n  }\n  where unitTest _ = tests\n')),(0,i.kt)("p",null,"The following explanations refer to the Escrow ",(0,i.kt)("a",{parentName:"p",href:"https://plutus-apps.readthedocs.io/en/latest/plutus/tutorials/contract-models.html"},"Contract Model Tutorial"),":"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"certCoverageIndex")),(0,i.kt)("p",null,"This is defined by giving a ",(0,i.kt)("inlineCode",{parentName:"p"},"CoverageIndex")," for the validators."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"certNoLockedFunds")),(0,i.kt)("p",null,"This is defined by giving a ",(0,i.kt)("inlineCode",{parentName:"p"},"noLockProof"),"."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"certCrashTolerance")),(0,i.kt)("p",null,"This is always defined by supplying ",(0,i.kt)("inlineCode",{parentName:"p"},"just Instance")," with the assumption that an instance of ",(0,i.kt)("inlineCode",{parentName:"p"},"CrashTolerance")," for the model is defined in scope. "),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"certUnitTests")),(0,i.kt)("p",null,"This is defined by supplying a ",(0,i.kt)("inlineCode",{parentName:"p"},"Tasty")," test tree. Note that the above definition ",(0,i.kt)("inlineCode",{parentName:"p"},"unitTest _ = tests")," is defined to take into account the ",(0,i.kt)("inlineCode",{parentName:"p"},"coverageRef")," argument."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"certDLTests")),(0,i.kt)("p",null,"This is defined by giving a list of pairs of ",(0,i.kt)("inlineCode",{parentName:"p"},"DL")," tests and strings indicating their names. A DL test is a unit test defined using the model. For more information about DL tests see ",(0,i.kt)("a",{parentName:"p",href:"https://hackage.haskell.org/package/quickcheck-dynamic-3.3.1/docs/Test-QuickCheck-DynamicLogic.html"},"Dynamic Logic Tests"),". An example DL test for the Escrow contract is given by:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-haskell"},"refundTest :: DL EscrowModel ()\nrefundTest = do\n               val <- forAllQ $ chooseQ (10, 20)\n               action $ Pay w1 val\n               waitUntilDL 100\n               action $ Refund w1\n")))}u.isMDXComponent=!0}}]);